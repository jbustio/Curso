<?xml version='1.0' encoding='utf-8'?>
<odoo>
  <!-- form for estate.property -->
  <record id="estate_property_form" model="ir.ui.view">
    <field name="name">estate.property.form</field>
    <field name="model">estate.property</field>
    <field name="arch" type="xml">
      <form string="Real Estate">
        <header>
          <button name="action_sell" string="Sold" states="new,offer_receive"
            class="btn btn-outline-primary disabled"
          />
          <button name="action_sell" string="Sold" states="offer_accepted" class="oe_highlight"
            type="object" decoration-primary="1==1"
          />

          <button name="action_cancel" string="Cancel" decoration-info="1==1"
            type="object" states="new,offer_receive,offer_accepted" />
          <!-- attrs="{'highlight': ['|',('state','=','sold') ,('state','=','canceled')]}" /> -->


          <field name="state" widget="statusbar"
            statusbar_visible="new,offer_receive,offer_accepted,sold,canceled" />

        </header>
        <sheet>
          <div class="oe_title">
            <h1>
              <field name="name" />
            </h1>
            <field name="tag_ids" widget="many2many_tags"
              options="{'create': False, 'color_field': 'color'}" />
          </div>
          <group>
            <group>
              <field name="property_type_id"
                decoration-info="1 == 1"
                options="{'no_create': True}" />
              <field name="date_availability" />
              <field name="state" />
            </group>
            <group>
              <field name="expected_price" />
              <field name="selling_price" />
              <field name="best_price" />
              <field name="active" />
            </group>
          </group>
          <notebook>
            <page string="Description">
              <field name="description" />
            </page>
            <page string="Other Info">
              <group>
                <group>
                  <field name="bedrooms" />
                  <field name="living_area" />
                  <field name="facades" />
                  <field name="postcode" />
                </group>
                <group>
                  <field name="garage" />
                  <field name="garden" />
                  <field name="garden_area"
                    attrs="{'invisible': [('garden','==',False)]}" />
                  <field
                    name="garden_orientation" attrs="{'invisible': [('garden','==',False)]}" />/> <field
                    name="total_area" />
                </group>
              </group>
            </page>
            <page string="Buyer/Saler Info">
              <group>
                <field name="salesperson_id" />
                <field name="buyer_id" />
              </group>
            </page>
            <page string="Offers">
              <field name="offer_ids"
                attrs="{'readonly': ['|','|', ('state','==','offer_accepted'), ('state','==','sold'),('state','==','canceled')]}" />
            </page>
          </notebook>
        </sheet>
      </form>
    </field>
  </record>
  <!-- estate- property tree -->
  <record id="estate_property_tree" model="ir.ui.view">
    <field name="name">estate.property.tree</field>
    <field name="model">estate.property</field>
    <field name="arch" type="xml">
      <tree string="Real Estate" decoration-bf="(state=='offer_accepted')"
        decoration-muted="(state=='sold')"
        decoration-success="(state=='offer_receive')or(state=='offer_accepted')">
        <field name="name" readonly="1" />
        <field name="postcode" readonly="1" />
        <field name="state" readonly="1" />
        <field name="date_availability" readonly="1" optional="hide" />
        <field name="expected_price" readonly="1" />
        <field name="tag_ids" widget="many2many_tags" options="{'color_field': 'color'}" />
        <field name="bedrooms" readonly="1" />
        <field name="living_area" readonly="1" />
        <field name="offer_ids" readonly="0" />
        <field name="facades" readonly="1" />
        <field name="garage" readonly="1" />
        <field name="garden" readonly="1" />
        <field name="garden_area" readonly="1" />
        <field name="garden_orientation" readonly="1" />
        <field name="selling_price" readonly="1" />
        <field name="active" readonly="1" />
      </tree>
    </field>
  </record>
  <!-- Search view for "estate.property" -->
  <record id="estate_property_search" model="ir.ui.view">
    <field name="name">estate.property.search</field>
    <field name="model">estate.property</field>
    <field name="type">search</field>
    <field name="mode">primary</field>
    <field name="priority" eval="16" />
    <field name="active" eval="True" />
    <field name="arch" type="xml">
      <search string="Real Estate">
        <field name="name" />
        <field name="description" />
        <field string="Living Area" name="living_area"
          filter_domain="[('living_area','>=',self),]" />
        <filter string="Available" name="available"
          domain="[('date_availability','&lt;',context_today()),('state', '!=', 'sold'),('state', '!=', 'cancelled')]" />


        <separator />
        <group expand="1" string="Group By">
          <filter string="Postcode" name="postcode"
            context="{'group_by':'postcode', 'residual_visible':True}" />
          <filter string="Garden" name="garden"
            context="{'group_by':'garden', 'residual_visible':True}" />
          <filter string="Garage" name="garage"
            context="{'group_by':'garage', 'residual_visible':True}" />
        </group>
      </search>
    </field>
  </record>
</odoo>